const gA="data:audio/mpeg;base64,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",dA="data:audio/mpeg;base64,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",bA="/page6/assets/door1-CGUW46fB.wav",BA="/page6/assets/bag-TcpZ8Nwp.mp3",wA="/page6/assets/bag_open-ig9X4wAM.mp3",uA="/page6/assets/trans-DlUaoYPT.mp3",qA="/page6/assets/sucess-C0BuqVm7.wav",pA="/page6/assets/failed-BNPLxPO-.mp3",hA="/page6/assets/horror-DFFpTguW.mp3",G=new Audio(gA),U=new Audio(dA),W=new Audio(bA),H=new Audio(BA),K=new Audio(wA),_A=new Audio(uA),v=new Audio(qA),M=new Audio(pA),m=new Audio(hA);m.loop=!0;G.pause();U.pause();W.pause();H.pause();K.pause();_A.pause();const A={golbal_arr:{},scene_arr:{},line_arr:[],close_arr:{},note_arr:[],last_id:0,line_id:0,line_length:0,wall:1,scene:[],line:[],bag:[0],key:{door:"",next:"",id:0},boss:0,heart:0,qte:0};A.bag;const z=document.querySelector("#screen"),B=document.querySelector("#screen_ui"),P=document.querySelector("#screen_bg"),j=document.querySelector("#scene_ux"),o=document.querySelector("#scene_bg"),Z=document.querySelector("#set_btn"),p=a("pop_note"),MA=a("next_scene_btn"),F=document.querySelector("#end_div"),EA=document.querySelector("#end_content"),fA=document.querySelector("#end_share"),X=document.querySelector("#end_retry"),q=a("lines_div"),$=a("lines_btn"),Y=a("lines_name"),r=(e,n)=>{var t;if(o.innerHTML="",j.innerHTML="",B.innerHTML="",n?A.scene=n[e]:A.scene=A.scene_arr[e],!!A.scene)switch(A.scene.bg&&(o.className=A.scene.bg),A.line_arr[e]&&(A.line_length=A.line_arr[e].length),A.scene.type){case"anim":AA(),o.addEventListener("animationend",s=>{s.animationName===A.scene.bg&&A.scene.type==="anim"&&(o.className="",r(A.scene.next))});break;case"line":d(e);break;case"close":A.line_length=0,d(e);break;case"view":A.last_id=e,d(e);break;case"room":A.last_id=e,o.className=`${A.scene.bg}-${A.wall}`,(t=A.line_arr[e])!=null&&t[A.wall]?(A.line_length=A.line_arr[e][A.wall].length,d(A.wall,A.line_arr[e])):d(e);break;case"qte":A.qte=0,o.className=`${A.scene.bg}-0`,d(e);break;case"end":o.addEventListener("animationend",s=>{A.scene&&A.scene.type==="end"&&s.animationName===A.scene.bg&&(A.golbal_arr.now_end=A.scene.end,MA.click())});break}},d=(e,n,t)=>{var s;if(B.innerHTML="",n?A.line=n[e]:A.scene.type==="room"||(A.line=A.line_arr[e]),A.line&&A.line_length>0)q.innerHTML="",q.textContent=A.line[A.line_id],t&&(Y.textContent=t,q.appendChild(Y)),q.appendChild($),B.appendChild(q),A.line_id+=1,U.currentTime="",U.play();else switch(A.line_id=0,A.scene.type){case"line":AA(),r(A.scene.next);break;case"close":k(),SA();break;case"view":A.line_arr[e]&&delete A.line_arr[e],k(),kA();break;case"room":(s=A.line_arr[e])!=null&&s[A.wall]&&delete A.line_arr[e][A.wall],k(),VA();break;case"qte":A.line_arr[e]&&delete A.line_arr[e],CA(),nA(),GA();break}},k=()=>{let e=A.scene.ux;A.scene.type==="room"&&(e=A.scene.ux[A.wall-1]),e.forEach(n=>{if(n.type==="item"&&A.bag.includes(n.is))return;const t=document.createElement("div");t.className="btns_ux",j.appendChild(t),t.style.left=n.x+"vh",t.style.top=n.y+"vh",t.style.width=n.w+"vh",t.style.height=n.h+"vh",n.bg&&t.classList.add(n.bg),t.addEventListener("click",s=>{mA(s,n)})})},mA=(e,n)=>{switch(n.type){case"note":A.line_length=A.note_arr[n.is].length,d(n.is,A.note_arr);break;case"close":r(n.is,A.close_arr);break;case"next":n.wall&&(A.wall=n.wall),r(n.is);break;case"item":A.bag.push(n.is),N("item",A.golbal_arr.item[n.is].name),e.target.style.display="none";break;case"npc":n.name,A.line_length=A.note_arr[n.is].length,d(n.is,A.note_arr,n.name);break}},AA=()=>{if(A.scene.change)A.scene.change.forEach(e=>{e.wall?e.ux==="add"?A.scene_arr[e.id].ux[e.wall-1].push(e.add):(A.scene_arr[e.id].ux[e.wall-1][e.ux].type=e.type,A.scene_arr[e.id].ux[e.wall-1][e.ux].is=e.is):e.ux==="add"?A.scene_arr[e.id].ux.push(e.add):(A.scene_arr[e.id].ux[e.ux].type=e.type,A.scene_arr[e.id].ux[e.ux].is=e.is)});else return},N=(e,n)=>{switch(z.appendChild(p),e){case"item":p.textContent=`${n} ${A.golbal_arr.pop.item}`,H.play();break;case"door":p.textContent=A.golbal_arr.pop.door;break}};p.addEventListener("animationend",e=>{e.animationName==="show_anim"&&z.removeChild(p)});const O=a("qte_div"),eA=a("qte_btn","ui_btns"),DA=a("qte_bar"),J=a("qte_box"),w=a("qte_dot"),D=a("feedback","gmui_btns"),y=a("userHeart"),C=a("bossHeart");let yA=0;function CA(){y.innerHTML="",C.innerHTML="",A.boss=A.scene.boss,A.heart=A.scene.user;for(let e=0;e<A.heart;e++){const n=a(0,"heart_icon");y.appendChild(n)}for(let e=0;e<A.boss;e++){const n=a(0,"boss_icon");C.appendChild(n)}}function nA(){yA=Date.now(),w.className="qte_start_anim",D.textContent=A.golbal_arr.qte,m.play()}function IA(){const n=window.getComputedStyle(w).transform;w.className="",w.style.transform=n}function LA(e,n){const t=e.getBoundingClientRect(),s=n.getBoundingClientRect();return t.left>=s.left&&t.right<=s.right}function QA(){const e=document.querySelector("#qte_bar");LA(w,e)?(D.textContent=A.golbal_arr.success,A.boss-=1,A.qte+=1,A.scene.mode==="fight"&&(o.className=`${A.scene.bg}-heart`),R("boss",C,A.boss),v.currentTime=0,M.currentTime=0,v.play(),M.play()):(D.textContent=A.golbal_arr.failed,A.heart-=1,A.scene.mode==="fight"&&(o.className=`${A.scene.bg}-boss`),R("heart",y,A.heart),M.currentTime=0,M.play()),IA()}function R(e,n,t){const s=n.querySelectorAll(`.${e}_icon`),g=s.length-t;if(g>0)for(let c=0;c<g;c++){const b=s[s.length-1-c];b.classList.add("heart_out_anim"),b.addEventListener("animationend",()=>{b.remove(),A.boss<1?(A.scene.reward&&(A.bag.push(A.scene.reward),N("item",A.golbal_arr.item[A.scene.reward].name)),r(A.scene.next),m.pause()):A.heart<1?(r(A.scene.end),m.pause()):(A.scene.mode==="run"?e==="boss"&&(o.className=`${A.scene.bg}-${A.qte}`):A.scene.mode==="fight"&&(o.className=`${A.scene.bg}-0`),nA())})}else if(g<0)for(let c=0;c<Math.abs(g);c++){const b=a(e,`${e}-icon`);n.appendChild(b)}}X.addEventListener("click",()=>{tA()});let S=!1;Z.addEventListener("click",T(()=>{tA()},300));const tA=()=>{S?F.style.zIndex=-1:(F.style.zIndex=1,Z.style.zIndex=2,EA.textContent=A.golbal_arr.end[0][0],fA.textContent=A.golbal_arr.end[0][1],X.textContent=A.golbal_arr.end[0][2]),S=!S},sA=a("btn_return","ui_btns"),h=a("btn_bag","ui_btns"),aA=a("btn_left","ui_btns"),lA=a("btn_right","ui_btns");$.addEventListener("click",T(()=>{A.line_length-=1,d(A.scene.id)},300));const kA=()=>{B.append(h)},SA=()=>{B.append(sA,h)};sA.addEventListener("click",()=>{r(A.last_id),I()});const VA=()=>{B.append(aA,lA,h)};aA.addEventListener("click",()=>{A.wall>1?A.wall-=1:A.wall=4,r(A.scene.id),I()});lA.addEventListener("click",()=>{A.wall<4?A.wall+=1:A.wall=1,r(A.scene.id),I()});const GA=()=>{J.appendChild(DA),O.append(C,D,J,y,w,eA),B.appendChild(O)};eA.addEventListener("click",()=>QA());const I=()=>{G.currentTime=0,G.play()},f=a("bag_div"),u=a("bag_slots","bag_slots_close"),l=a("bag_view"),L=a(0,"bag_slots_btn_close"),x=a("bag_key_btn");let V=!1,_=!1;h.addEventListener("click",T(()=>{V?(P.removeChild(f),I()):(cA(),oA(),K.play()),V=!V},300));const oA=()=>{f.innerHTML="",u.innerHTML="",l.innerHTML="",l.classList="",f.append(l,u,L),A.bag.forEach((e,n)=>{const t=a(A.golbal_arr.item[e].bg,"bag_icon");t.draggable=!0,xA(t,e),u.appendChild(t),t.addEventListener("click",()=>{_||(l.innerHTML="",x.textContent=A.golbal_arr.use,l.className!==A.golbal_arr.item[e].bg?(l.className=A.golbal_arr.item[e].bg,A.golbal_arr.item[e].type==="key"&&(l.appendChild(x),A.key.door=A.golbal_arr.item[e].door,A.key.next=A.golbal_arr.item[e].next,A.key.id=e)):l.className="")})}),P.appendChild(f)};L.addEventListener("click",()=>{_?cA():UA()});x.addEventListener("click",()=>{W.play(),o.className===A.key.door?(r(A.key.next),h.click(),A.bag=A.bag.filter(e=>e!==A.key.id),A.wall=1):N("door")});const cA=()=>{_=!1,l.style.height="100%",u.className="bag_slots_close",L.classList="bag_slots_btn_close"},UA=()=>{_=!0,l.style.height="0%",l.innerHTML="",l.classList="",u.className="bag_slots_open",L.classList="bag_slots_btn_open"};let i=null,E=null;function xA(e,n){e.addEventListener("touchstart",function(t){_&&(i=e,E=n)}),e.addEventListener("touchmove",function(t){if(!i)return;i.style.position="absolute";var s=t.targetTouches[0];const g=parseFloat(window.getComputedStyle(i).width),c=parseFloat(window.getComputedStyle(i).height);i.style.left=s.screenX-window.innerWidth/2+g*1.2+"px",i.style.top=s.screenY-window.innerHeight/2+c*1.2+"px"}),e.addEventListener("touchend",function(t){if(!i)return;const s=Math.floor((t.changedTouches[0].pageX-u.offsetLeft)/i.offsetWidth),g=Math.max(0,Math.min(A.bag.length-1,s)),c=A.bag[E];A.bag[E]=A.bag[g],A.bag[g]=c;const b=A.bag.filter((Q,iA,rA)=>Q!==void 0&&Q!==""&&rA.indexOf(Q)===iA);A.bag=b,oA(),i=null,E=null})}function a(e,n,t){const s=document.createElement("div");return e&&(s.id=e),n&&(s.className=n),s}function T(e,n=100){let t;return(...s)=>{clearTimeout(t),t=setTimeout(()=>e.apply(this,s),n)}}export{mA as click_ux,X as end_retry,d as new_line,r as new_scene,MA as next_scene_btn,k as render_ux,A as user};
